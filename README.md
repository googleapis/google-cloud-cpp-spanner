# Google Cloud Spanner C++ Client Library

<!-- This file is automatically generated by ci/test-readme/generate-readme.sh -->"
Cloud Spanner is the only enterprise-grade, globally-distributed, and
strongly consistent database service built for the cloud specifically
to combine the benefits of relational database structure with
non-relational horizontal scale. This combination delivers
high-performance transactions and strong consistency across rows,
regions, and continents with an industry-leading 99.999% availability
SLA, no planned downtime, and enterprise-grade security. Cloud Spanner
revolutionizes database administration and management and makes
application development more efficient.

This repository contains the implementation of the Cloud Spanner C++
client library.

## Status

This library supports Cloud Spanner at the [Alpha](README.md#versioning) quality
level. The library should be usable for experimental code, but we do not
recommend that you use this library for production workloads. Please note that,
as is often the case with C++ libraries, we do **not** follow semantic
versioning in the Cloud C++ client libraries. We make every effort to document
backwards-incompatible API changes in the
[release notes](README.md#release-notes) below.


**Core Builds**
[![CI status docker/asan][docker/asan-shield]][docker/asan-link]
[![CI status docker/bazel-dependency][docker/bazel-dependency-shield]][docker/bazel-dependency-link]
[![CI status docker/clang-3.8][docker/clang-3.8-shield]][docker/clang-3.8-link]
[![CI status docker/clang-tidy][docker/clang-tidy-shield]][docker/clang-tidy-link]
[![CI status docker/cmake][docker/cmake-shield]][docker/cmake-link]
[![CI status docker/cmake-super][docker/cmake-super-shield]][docker/cmake-super-link]
[![CI status docker/coverage][docker/coverage-shield]][docker/coverage-link]
[![CI status docker/cxx17][docker/cxx17-shield]][docker/cxx17-link]
[![CI status docker/gcc-4.8][docker/gcc-4.8-shield]][docker/gcc-4.8-link]
[![CI status docker/integration][docker/integration-shield]][docker/integration-link]
[![CI status docker/msan][docker/msan-shield]][docker/msan-link]
[![CI status docker/noex][docker/noex-shield]][docker/noex-link]
[![CI status docker/publish-refdocs][docker/publish-refdocs-shield]][docker/publish-refdocs-link]
[![CI status docker/tsan][docker/tsan-shield]][docker/tsan-link]
[![CI status docker/ubsan][docker/ubsan-shield]][docker/ubsan-link]
[![CI status macos/bazel][macos/bazel-shield]][macos/bazel-link]
[![CI status macos/cmake-super][macos/cmake-super-shield]][macos/cmake-super-link]
[![CI status windows/bazel][windows/bazel-shield]][windows/bazel-link]
[![CI status windows/cmake][windows/cmake-shield]][windows/cmake-link]
[![Code Coverage Status][codecov-io-badge]][codecov-io-link]
[![Link to Reference Documentation][doxygen-shield]][doxygen-link]

**Install Instructions**
[![CI status install/fedora][install/fedora-shield]][install/fedora-link]

[docker/asan-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/asan-link.html
[docker/asan-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/asan.svg
[docker/bazel-dependency-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/bazel-dependency-link.html
[docker/bazel-dependency-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/bazel-dependency.svg
[docker/clang-3.8-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/clang-3.8-link.html
[docker/clang-3.8-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/clang-3.8.svg
[docker/clang-tidy-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/clang-tidy-link.html
[docker/clang-tidy-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/clang-tidy.svg
[docker/cmake-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/cmake-link.html
[docker/cmake-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/cmake.svg
[docker/cmake-super-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/cmake-super-link.html
[docker/cmake-super-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/cmake-super.svg
[docker/coverage-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/coverage-link.html
[docker/coverage-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/coverage.svg
[docker/cxx17-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/cxx17-link.html
[docker/cxx17-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/cxx17.svg
[docker/gcc-4.8-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/gcc-4.8-link.html
[docker/gcc-4.8-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/gcc-4.8.svg
[docker/integration-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/integration-link.html
[docker/integration-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/integration.svg
[docker/msan-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/msan-link.html
[docker/msan-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/msan.svg
[docker/noex-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/noex-link.html
[docker/noex-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/noex.svg
[docker/publish-refdocs-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/publish-refdocs-link.html
[docker/publish-refdocs-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/publish-refdocs.svg
[docker/tsan-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/tsan-link.html
[docker/tsan-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/tsan.svg
[docker/ubsan-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/ubsan-link.html
[docker/ubsan-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/docker/ubsan.svg
[install/fedora-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/install/fedora-link.html
[install/fedora-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/install/fedora.svg
[macos/bazel-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/macos/bazel-link.html
[macos/bazel-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/macos/bazel.svg
[macos/cmake-super-link]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/macos/cmake-super-link.html
[macos/cmake-super-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner/macos/cmake-super.svg
[codecov-io-badge]: https://codecov.io/gh/googleapis/google-cloud-cpp-spanner/branch/master/graph/badge.svg
[codecov-io-link]: https://codecov.io/gh/googleapis/google-cloud-cpp-spanner
[doxygen-shield]: https://img.shields.io/badge/documentation-master-brightgreen.svg
[doxygen-link]: https://googleapis.dev/cpp/google-cloud-spanner/latest/
[windows/bazel-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner-windows-bazel.svg
[windows/bazel-link]:   https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner-windows-bazel-link.html
[windows/cmake-shield]: https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner-windows-cmake.svg
[windows/cmake-link]:   https://storage.googleapis.com/cloud-cpp-kokoro-status/spanner-windows-cmake-link.html

**Build with the latest bazel release**
[![Build status][bazelci-shield]][bazelci-link]

[bazelci-shield]: https://badge.buildkite.com/414b5f8e146fdf26017f069e3b464d7df1caa6bfa5ec627ef9.svg
[bazelci-link]: https://buildkite.com/bazel/github-dot-com-googleapis-google-cloud-cpp-spanner

## Documentation

The [reference documentation][doxygen-link] for this client library is available online.
Please consult the [Cloud Spanner website][cloud-spanner-docs] for
general documentation on Cloud Spanner features, APIs, other client
libraries, etc.

[cloud-spanner-docs]: https://cloud.google.com/spanner/docs/

## Contributing changes

See [`CONTRIBUTING.md`](CONTRIBUTING.md) for details on how to contribute to
this project, including how to build and test your changes as well as how to
properly format your code.

## Licensing

Apache 2.0; see [`LICENSE`](LICENSE) for details.

## Release Notes

### v0.4.x - TBD

### v0.3.x - 2019-11

* **Breaking Changes**
    * feat!: class templates removed from keys.h (#936)
    * feat!: change result return types (#942)
    * refactor!: replaced Row<...> with std::tuple<...> (#967)
    * feat!: support for select-star queries (#976)
    * feat!: replace RunTransaction() with Client::Commit(functor) (#975)
    * chore!: renamed QueryResult to RowStream (#978)
    * chore!: renamed ExecuteSqlParams to SqlParams (#986)
    * cleanup: depend on google-cloud-cpp-common (#940)

* feat: configurable strategy for background threads (#955)
* feat: add Profile and Analyze methods (#961)
* feat: adds efficient move to support to Value:get<string>() (#980)
* feat: add efficient move support to mutation builder temporaries (#989)
* bug: only install the required headers (#993)
* bug: install the headers for mocking (#997)

### v0.2.x - 2019-10
* **Breaking Changes**
  * refactor `Read` to return `ReadResult`; remove `ResultSet` (#935)
  * removed `Row<>` from mutations API (#938). Removes the `AddRow(Row<Ts...>)`
    member function on the `WriteMutation` API. In place of this method there
    is now an `AddRow(std::vector<Value>)` method.
  * Change `Value::Bytes` to `google::cloud::spanner::Bytes` (#920)
  * implement `CreateInstanceRequestBuilder` (#933). Changed the function
    signature of `InstanceAdminClient::CreateInstance()`.
  * Replace `ExecuteSql` with `ExecuteQuery` and `ExecuteDml` (#927)
  * Changed `RowParser` to require a `Row<Ts...>` template param (#653).
    `ResultSet::Rows` used to be a variadic template that took the individual
     C++ types for each row. With this change that function is now a template
     with one parameter, which must be a `Row<...>` type.
  * Implements `Database` in terms of `Instance` (#652). This PR removes
    renames some accessors like `InstanceId` -> `instance_id` due to their
    trivial nature now (style guide). It also removes some methods like
    `Database::ParentName()`, which is now replaced by `Database::instance()`.
  * Fixes inconsistent naming of the Batch DML params struct. (#650). This
    struct has been renamed, so any code using this struct will need to be
    updated.

* **Feature changes**
  * implement `InstanceAdminClient` methods `CreateInstance`, `UpdateInstance`,
    `DeleteInstance`, `ListInstanceConfigs`, `GetInstanceConfig`,
     `SetIamPolicy`.
  * implement `DatabaseAdminClient` methods `TestIamPermissions`,
    `SetIamPolicy`, `GetIamPolicy`.
  * implement retries for `Commit()`, `PartitionRead`, `PartitionQuery`,
    `ExecuteBatchDml`, `CreateSession`, `Rollback`.
  * implement `PartialResultSetRead` with resumes (#693)
  * use separate policies for retry vs. rerun (#667)
  * implement `DatabaseAdminConnection` (#638)
  * implement overloads on `UpdateInstanceRequestBuilder` (#921)
  * implement metadata decorator for `InstanceAdminStub`. (#678)
  * implement logging wrapper for `InstanceAdminStub`. (#676)
  * support install components for the library (#659)

* **Bug fixes**
  * fix runtime install directory (#658)
  * give sample programs a long timeout time. (#622)
  * use RunTransaction for read write transaction sample (#654)

### v0.1.x - 2019-09

* This is the initial Alpha release of the library.
* While this version is not recommended for production workloads it is stable
  enough to use in experimental code. We welcome feedback about the library
  through [GitHub issues][GitHub-new-issue].
* The API is expected to undergo incompatible changes before Beta and GA.
* The library supports all the operations to read and write data into Cloud
  Spanner.
* The library supports some administrative operations such as creating,
  updating, and dropping databases.

[GitHub-new-issue]: https://github.com/googleapis/google-cloud-cpp-spanner/issues/new

## Versioning

Please note that the Google Cloud C++ client libraries do **not** follow
[Semantic Versioning](http://semver.org/).

**GA**: Libraries defined at a GA quality level are expected to be stable and
any backwards-incompatible changes will be noted in the documentation. Major
changes to the API will signaled by changing major version number
(e.g. 1.x.y -> 2.0.0).

**Beta**: Libraries defined at a Beta quality level are expected to be mostly
stable and we're working towards their release candidate. We will address issues
and requests with a higher priority.

**Alpha**: Libraries defined at an Alpha quality level are still a
work-in-progress and are more likely to get backwards-incompatible updates.
Additionally, it's possible for Alpha libraries to get deprecated and deleted
before ever being promoted to Beta or GA.

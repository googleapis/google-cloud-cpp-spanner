<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Google Cloud Spanner C++ Client: google::cloud::spanner::v0::DatabaseAdminClient Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Google Cloud Spanner C++ Client
   &#160;<span id="projectnumber">0.8.0</span>
   </div>
   <div id="projectbrief">A C++ Client Library for Google Cloud Spanner</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacegoogle.html">google</a></li><li class="navelem"><a class="el" href="namespacegoogle_1_1cloud.html">cloud</a></li><li class="navelem"><a class="el" href="namespacegoogle_1_1cloud_1_1spanner.html">spanner</a></li><li class="navelem"><a class="el" href="namespacegoogle_1_1cloud_1_1spanner_1_1v0.html">v0</a></li><li class="navelem"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html">DatabaseAdminClient</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">google::cloud::spanner::v0::DatabaseAdminClient Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Performs database administration operations on Spanner.  
 <a href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="database__admin__client_8h_source.html">google/cloud/spanner/database_admin_client.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5359f2621faada447be80416df5e2eba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#a5359f2621faada447be80416df5e2eba">DatabaseAdminClient</a> (<a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1ConnectionOptions.html">ConnectionOptions</a> const &amp;options=<a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1ConnectionOptions.html">ConnectionOptions</a>())</td></tr>
<tr class="separator:a5359f2621faada447be80416df5e2eba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af19c5d53e7f32bba140cd74fdf4dfe05"><td class="memItemLeft" align="right" valign="top">future&lt; StatusOr&lt; google::spanner::admin::database::v1::Database &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#af19c5d53e7f32bba140cd74fdf4dfe05">CreateDatabase</a> (<a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a> db, std::vector&lt; std::string &gt; extra_statements={})</td></tr>
<tr class="memdesc:af19c5d53e7f32bba140cd74fdf4dfe05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new Cloud Spanner database in the given project and instance.  <a href="#af19c5d53e7f32bba140cd74fdf4dfe05">More...</a><br /></td></tr>
<tr class="separator:af19c5d53e7f32bba140cd74fdf4dfe05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f4ce7fb02cbbede35467247c5b42b00"><td class="memItemLeft" align="right" valign="top">StatusOr&lt; google::spanner::admin::database::v1::Database &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#a9f4ce7fb02cbbede35467247c5b42b00">GetDatabase</a> (<a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a> db)</td></tr>
<tr class="memdesc:a9f4ce7fb02cbbede35467247c5b42b00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve metadata information about a database.  <a href="#a9f4ce7fb02cbbede35467247c5b42b00">More...</a><br /></td></tr>
<tr class="separator:a9f4ce7fb02cbbede35467247c5b42b00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75e7f11200ee24f0fb26b63972b0869f"><td class="memItemLeft" align="right" valign="top">StatusOr&lt; google::spanner::admin::database::v1::GetDatabaseDdlResponse &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#a75e7f11200ee24f0fb26b63972b0869f">GetDatabaseDdl</a> (<a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a> db)</td></tr>
<tr class="memdesc:a75e7f11200ee24f0fb26b63972b0869f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve a database schema.  <a href="#a75e7f11200ee24f0fb26b63972b0869f">More...</a><br /></td></tr>
<tr class="separator:a75e7f11200ee24f0fb26b63972b0869f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a772381bd10480013561ad30dccd3f7db"><td class="memItemLeft" align="right" valign="top">future&lt; StatusOr&lt; google::spanner::admin::database::v1::UpdateDatabaseDdlMetadata &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#a772381bd10480013561ad30dccd3f7db">UpdateDatabase</a> (<a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a> db, std::vector&lt; std::string &gt; statements)</td></tr>
<tr class="memdesc:a772381bd10480013561ad30dccd3f7db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the database using a series of DDL statements.  <a href="#a772381bd10480013561ad30dccd3f7db">More...</a><br /></td></tr>
<tr class="separator:a772381bd10480013561ad30dccd3f7db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3443f1da6c949d195ac76b7ed6776c4"><td class="memItemLeft" align="right" valign="top">Status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#ab3443f1da6c949d195ac76b7ed6776c4">DropDatabase</a> (<a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a> db)</td></tr>
<tr class="memdesc:ab3443f1da6c949d195ac76b7ed6776c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Drops (deletes) an existing Cloud Spanner database.  <a href="#ab3443f1da6c949d195ac76b7ed6776c4">More...</a><br /></td></tr>
<tr class="separator:ab3443f1da6c949d195ac76b7ed6776c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae787f480f6b2ecc3bee04c2b23428390"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacegoogle_1_1cloud_1_1spanner_1_1v0.html#ab2103cd7782fc4748867fa8ad2b35e09">ListDatabaseRange</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#ae787f480f6b2ecc3bee04c2b23428390">ListDatabases</a> (<a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Instance.html">Instance</a> in)</td></tr>
<tr class="memdesc:ae787f480f6b2ecc3bee04c2b23428390"><td class="mdescLeft">&#160;</td><td class="mdescRight">List all the databases in a give project and instance.  <a href="#ae787f480f6b2ecc3bee04c2b23428390">More...</a><br /></td></tr>
<tr class="separator:ae787f480f6b2ecc3bee04c2b23428390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18fff0d95cb3a597746ae6253c7dbc24"><td class="memItemLeft" align="right" valign="top">StatusOr&lt; google::iam::v1::Policy &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#a18fff0d95cb3a597746ae6253c7dbc24">GetIamPolicy</a> (<a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a> db)</td></tr>
<tr class="memdesc:a18fff0d95cb3a597746ae6253c7dbc24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the IAM policy for a database.  <a href="#a18fff0d95cb3a597746ae6253c7dbc24">More...</a><br /></td></tr>
<tr class="separator:a18fff0d95cb3a597746ae6253c7dbc24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8f5a36a409bf2f0161fdf37488a7d8d"><td class="memItemLeft" align="right" valign="top">StatusOr&lt; google::iam::v1::Policy &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#af8f5a36a409bf2f0161fdf37488a7d8d">SetIamPolicy</a> (<a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a> db, google::iam::v1::Policy policy)</td></tr>
<tr class="memdesc:af8f5a36a409bf2f0161fdf37488a7d8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the IAM policy for the given database.  <a href="#af8f5a36a409bf2f0161fdf37488a7d8d">More...</a><br /></td></tr>
<tr class="separator:af8f5a36a409bf2f0161fdf37488a7d8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a27a871994081f7cb7ad726b4aecc60"><td class="memItemLeft" align="right" valign="top">StatusOr&lt; google::iam::v1::Policy &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#a8a27a871994081f7cb7ad726b4aecc60">SetIamPolicy</a> (<a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a> const &amp;db, <a class="el" href="namespacegoogle_1_1cloud_1_1spanner_1_1v0.html#a17be538be6a68b58dc90bd72c47af092">IamUpdater</a> const &amp;updater)</td></tr>
<tr class="memdesc:a8a27a871994081f7cb7ad726b4aecc60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the IAM policy for an instance using an optimistic concurrency control loop.  <a href="#a8a27a871994081f7cb7ad726b4aecc60">More...</a><br /></td></tr>
<tr class="separator:a8a27a871994081f7cb7ad726b4aecc60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3904f44d08265ea643460b60430b2f4"><td class="memItemLeft" align="right" valign="top">StatusOr&lt; google::iam::v1::Policy &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#ae3904f44d08265ea643460b60430b2f4">SetIamPolicy</a> (<a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a> const &amp;db, <a class="el" href="namespacegoogle_1_1cloud_1_1spanner_1_1v0.html#a17be538be6a68b58dc90bd72c47af092">IamUpdater</a> const &amp;updater, std::unique_ptr&lt; <a class="el" href="namespacegoogle_1_1cloud_1_1spanner_1_1v0.html#a52b5d68feb45c40d761c79ee360b804c">TransactionRerunPolicy</a> &gt; rerun_policy, std::unique_ptr&lt; <a class="el" href="namespacegoogle_1_1cloud_1_1spanner_1_1v0.html#ae9894cd07fd5d6262b10e01f1307c951">BackoffPolicy</a> &gt; backoff_policy)</td></tr>
<tr class="memdesc:ae3904f44d08265ea643460b60430b2f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the IAM policy for an instance using an optimistic concurrency control loop.  <a href="#ae3904f44d08265ea643460b60430b2f4">More...</a><br /></td></tr>
<tr class="separator:ae3904f44d08265ea643460b60430b2f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a440216e84d05c6e7f7fd285012d342e8"><td class="memItemLeft" align="right" valign="top">StatusOr&lt; google::iam::v1::TestIamPermissionsResponse &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#a440216e84d05c6e7f7fd285012d342e8">TestIamPermissions</a> (<a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a> db, std::vector&lt; std::string &gt; permissions)</td></tr>
<tr class="memdesc:a440216e84d05c6e7f7fd285012d342e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the subset of the permissions the caller has on the given database.  <a href="#a440216e84d05c6e7f7fd285012d342e8">More...</a><br /></td></tr>
<tr class="separator:a440216e84d05c6e7f7fd285012d342e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56ab3b13f17513c6c4fca01a4bc7ba7c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#a56ab3b13f17513c6c4fca01a4bc7ba7c">DatabaseAdminClient</a> (std::shared_ptr&lt; <a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminConnection.html">DatabaseAdminConnection</a> &gt; c)</td></tr>
<tr class="memdesc:a56ab3b13f17513c6c4fca01a4bc7ba7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new client with the given stub. For testing only.  <a href="#a56ab3b13f17513c6c4fca01a4bc7ba7c">More...</a><br /></td></tr>
<tr class="separator:a56ab3b13f17513c6c4fca01a4bc7ba7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Performs database administration operations on Spanner. </p>
<p>Applications use this class to perform administrative operations on spanner <a href="https://cloud.google.com/spanner/docs/schema-and-data-model">Databases</a>.</p>
<dl class="section user"><dt>Performance</dt><dd></dd></dl>
<p>Creating a new <code><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html" title="Performs database administration operations on Spanner.">DatabaseAdminClient</a></code> is a relatively expensive operation, new objects establish new connections to the service. In contrast, copying or moving an existing <code><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html" title="Performs database administration operations on Spanner.">DatabaseAdminClient</a></code> object is a relatively cheap operation. Copied clients share the underlying resources.</p>
<dl class="section user"><dt>Thread Safety</dt><dd></dd></dl>
<p>Instances of this class created via copy-construction or copy-assignment share the underlying pool of connections. Access to these copies via multiple threads is guaranteed to work. Two threads operating on the same instance of this class is not guaranteed to work.</p>
<dl class="section user"><dt>Error Handling</dt><dd></dd></dl>
<p>This class uses <code>StatusOr&lt;T&gt;</code> to report errors. When an operation fails to perform its work the returned <code>StatusOr&lt;T&gt;</code> contains the error details. If the <code>ok()</code> member function in the <code>StatusOr&lt;T&gt;</code> returns <code>true</code> then it contains the expected result. Please consult the <a href="#google::cloud::v0::StatusOr"><code>StatusOr&lt;T&gt;</code> documentation</a> for more details.</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code" href="namespacegoogle_1_1cloud_1_1spanner.html">spanner</a> = ::google::cloud::spanner;</div><div class="line">using ::google::cloud::StatusOr;</div><div class="line">spanner::DatabaseAdminClient client = ...;</div><div class="line">StatusOr&lt;google::spanner::admin::database::v1::Database&gt; db =</div><div class="line">    client.CreateDatabase(...).get();</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (!db) {</div><div class="line">  std::cerr &lt;&lt; <span class="stringliteral">&quot;Error in CreateDatabase: &quot;</span> &lt;&lt; db.status() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">  <span class="keywordflow">return</span>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Use `db` as a smart pointer here, e.g.:</span></div><div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;The database fully qualified name is: &quot;</span> &lt;&lt; db-&gt;name() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div></div><!-- fragment --><dl class="section user"><dt>Long running operations</dt><dd></dd></dl>
<p>Some operations in this class can take minutes to complete. In this case the class returns a <code>google::cloud::future&lt;StatusOr&lt;T&gt;&gt;</code>, the application can then poll the <code>future</code> or associate a callback to be invoked when the operation completes:</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code" href="namespacegoogle_1_1cloud_1_1spanner.html">spanner</a> = ::google::cloud::spanner;</div><div class="line">spanner::DatabaseAdminClient client = ...;</div><div class="line"><span class="comment">// Make example less verbose.</span></div><div class="line">using ::google::cloud::future;</div><div class="line">using ::google::cloud::StatusOr;</div><div class="line"><span class="keyword">using</span> std::chrono::chrono_literals; <span class="comment">// C++14</span></div><div class="line"></div><div class="line"><span class="keyword">auto</span> database = client.CreateDatabase(...);</div><div class="line"><span class="keywordflow">if</span> (database.wait_for(5m) == std::future_state::ready) {</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Database created in under 5 minutes, yay!\n&quot;</span>;</div><div class="line">  <span class="keywordflow">return</span>;</div><div class="line">}</div><div class="line"><span class="comment">// Too slow, setup a callback instead:</span></div><div class="line">database.then([](<span class="keyword">auto</span> f) {</div><div class="line">  StatusOr&lt;google::spanner::admin::database::v1::Database&gt; db = f.get();</div><div class="line">  <span class="keywordflow">if</span> (!db) {</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">&quot;Failed creating a database!\n&quot;</span>;</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">  }</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Database created!\n&quot;</span>;</div><div class="line">});</div></div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="database__admin__client_8h_source.html#l00109">109</a> of file <a class="el" href="database__admin__client_8h_source.html">database_admin_client.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a5359f2621faada447be80416df5e2eba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5359f2621faada447be80416df5e2eba">&#9670;&nbsp;</a></span>DatabaseAdminClient() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">google::cloud::spanner::v0::DatabaseAdminClient::DatabaseAdminClient </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1ConnectionOptions.html">ConnectionOptions</a> const &amp;&#160;</td>
          <td class="paramname"><em>options</em> = <code><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1ConnectionOptions.html">ConnectionOptions</a>()</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="database__admin__client_8cc_source.html#l00026">26</a> of file <a class="el" href="database__admin__client_8cc_source.html">database_admin_client.cc</a>.</p>

</div>
</div>
<a id="a56ab3b13f17513c6c4fca01a4bc7ba7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56ab3b13f17513c6c4fca01a4bc7ba7c">&#9670;&nbsp;</a></span>DatabaseAdminClient() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">google::cloud::spanner::v0::DatabaseAdminClient::DatabaseAdminClient </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminConnection.html">DatabaseAdminConnection</a> &gt;&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a new client with the given stub. For testing only. </p>

<p class="definition">Definition at line <a class="el" href="database__admin__client_8h_source.html#l00315">315</a> of file <a class="el" href="database__admin__client_8h_source.html">database_admin_client.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="af19c5d53e7f32bba140cd74fdf4dfe05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af19c5d53e7f32bba140cd74fdf4dfe05">&#9670;&nbsp;</a></span>CreateDatabase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">future&lt; StatusOr&lt; gcsa::Database &gt; &gt; google::cloud::spanner::v0::DatabaseAdminClient::CreateDatabase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a>&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>extra_statements</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new Cloud Spanner database in the given project and instance. </p>
<p>This function creates a database (using the "CREATE DATABASE" DDL statement) in the given Google Cloud Project and Cloud Spanner instance. The application can provide an optional list of additional DDL statements to atomically create tables and indices as well as the new database.</p>
<p>Note that the database id must be between 2 and 30 characters long, it must start with a lowercase letter (<code>[a-z]</code>), it must end with a lowercase letter or a number (<code>[a-z0-9]</code>) and any characters between the beginning and ending characters must be lower case letters, numbers, underscore (<code>_</code>) or dashes (<code>-</code>), that is, they must belong to the <code>[a-z0-9_-]</code> character set.</p>
<dl class="section return"><dt>Returns</dt><dd>A <code>google::cloud::future</code> that becomes satisfied when the operation completes on the service. Note that this can take minutes in some cases.</dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#af19c5d53e7f32bba140cd74fdf4dfe05">CreateDatabase</a>(google::cloud::spanner::DatabaseAdminClient client,</div><div class="line">                    std::string <span class="keyword">const</span>&amp; project_id,</div><div class="line">                    std::string <span class="keyword">const</span>&amp; instance_id,</div><div class="line">                    std::string <span class="keyword">const</span>&amp; database_id) {</div><div class="line">  using ::google::cloud::future;</div><div class="line">  using ::google::cloud::StatusOr;</div><div class="line">  google::cloud::spanner::Database database(project_id, instance_id,</div><div class="line">                                            database_id);</div><div class="line">  future&lt;StatusOr&lt;google::spanner::admin::database::v1::Database&gt;&gt; f =</div><div class="line">      client.CreateDatabase(database, {R<span class="stringliteral">&quot;&quot;&quot;(</span></div><div class="line"><span class="stringliteral">          CREATE TABLE Singers (</span></div><div class="line"><span class="stringliteral">              SingerId   INT64 NOT NULL,</span></div><div class="line"><span class="stringliteral">              FirstName  STRING(1024),</span></div><div class="line"><span class="stringliteral">              LastName   STRING(1024),</span></div><div class="line"><span class="stringliteral">              SingerInfo BYTES(MAX)</span></div><div class="line"><span class="stringliteral">          ) PRIMARY KEY (SingerId))&quot;&quot;&quot;,</span></div><div class="line"><span class="stringliteral">                                       R</span><span class="stringliteral">&quot;&quot;&quot;(</span></div><div class="line"><span class="stringliteral">          CREATE TABLE Albums (</span></div><div class="line"><span class="stringliteral">              SingerId     INT64 NOT NULL,</span></div><div class="line"><span class="stringliteral">              AlbumId      INT64 NOT NULL,</span></div><div class="line"><span class="stringliteral">              AlbumTitle   STRING(MAX)</span></div><div class="line"><span class="stringliteral">          ) PRIMARY KEY (SingerId, AlbumId),</span></div><div class="line"><span class="stringliteral">              INTERLEAVE IN PARENT Singers ON DELETE CASCADE)&quot;&quot;&quot;});</span></div><div class="line"><span class="stringliteral">  StatusOr&lt;google::spanner::admin::database::v1::Database&gt; db = f.get();</span></div><div class="line"><span class="stringliteral">  </span><span class="keywordflow">if</span> (!db) <span class="keywordflow">throw</span> std::runtime_error(db.status().message());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Created database [&quot;</span> &lt;&lt; database &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;</div><div class="line">}</div></div><!-- fragment --> </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://cloud.google.com/spanner/docs/data-definition-language">https://cloud.google.com/spanner/docs/data-definition-language</a> for a full list of the DDL operations</dd>
<dd>
<a href="https://cloud.google.com/spanner/docs/data-definition-language#create_database">https://cloud.google.com/spanner/docs/data-definition-language#create_database</a> for the regular expression that must be satisfied by the database id. </dd></dl>

<p class="definition">Definition at line <a class="el" href="database__admin__client_8cc_source.html#l00029">29</a> of file <a class="el" href="database__admin__client_8cc_source.html">database_admin_client.cc</a>.</p>

</div>
</div>
<a id="ab3443f1da6c949d195ac76b7ed6776c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3443f1da6c949d195ac76b7ed6776c4">&#9670;&nbsp;</a></span>DropDatabase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Status google::cloud::spanner::v0::DatabaseAdminClient::DropDatabase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a>&#160;</td>
          <td class="paramname"><em>db</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Drops (deletes) an existing Cloud Spanner database. </p>
<dl class="section warning"><dt>Warning</dt><dd>Dropping a database deletes all the tables and other data in the database. This is an unrecoverable operation.</dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#ab3443f1da6c949d195ac76b7ed6776c4">DropDatabase</a>(google::cloud::spanner::DatabaseAdminClient client,</div><div class="line">                  std::string <span class="keyword">const</span>&amp; project_id, std::string <span class="keyword">const</span>&amp; instance_id,</div><div class="line">                  std::string <span class="keyword">const</span>&amp; database_id) {</div><div class="line">  google::cloud::spanner::Database database(project_id, instance_id,</div><div class="line">                                            database_id);</div><div class="line">  google::cloud::Status status = client.DropDatabase(database);</div><div class="line">  <span class="keywordflow">if</span> (!status.ok()) <span class="keywordflow">throw</span> std::runtime_error(status.message());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Database &quot;</span> &lt;&lt; database &lt;&lt; <span class="stringliteral">&quot; successfully dropped\n&quot;</span>;</div><div class="line">}</div></div><!-- fragment --></dd></dl>

<p class="definition">Definition at line <a class="el" href="database__admin__client_8cc_source.html#l00053">53</a> of file <a class="el" href="database__admin__client_8cc_source.html">database_admin_client.cc</a>.</p>

</div>
</div>
<a id="a9f4ce7fb02cbbede35467247c5b42b00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f4ce7fb02cbbede35467247c5b42b00">&#9670;&nbsp;</a></span>GetDatabase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatusOr&lt; gcsa::Database &gt; google::cloud::spanner::v0::DatabaseAdminClient::GetDatabase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a>&#160;</td>
          <td class="paramname"><em>db</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve metadata information about a database. </p>
<dl class="section user"><dt>Idempotency</dt><dd>This is a read-only operation and therefore always idempotent. Transient failures are automatically retried.</dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#a9f4ce7fb02cbbede35467247c5b42b00">GetDatabase</a>(google::cloud::spanner::DatabaseAdminClient client,</div><div class="line">                 std::string <span class="keyword">const</span>&amp; project_id, std::string <span class="keyword">const</span>&amp; instance_id,</div><div class="line">                 std::string <span class="keyword">const</span>&amp; database_id) {</div><div class="line">  <span class="keyword">namespace </span><a class="code" href="namespacegoogle_1_1cloud_1_1spanner.html">spanner</a> = ::google::cloud::spanner;</div><div class="line">  <span class="keyword">auto</span> database = client.GetDatabase(</div><div class="line">      spanner::Database(project_id, instance_id, database_id));</div><div class="line">  <span class="keywordflow">if</span> (!database) <span class="keywordflow">throw</span> std::runtime_error(database.status().message());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Database metadata is:\n&quot;</span> &lt;&lt; database-&gt;DebugString() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">}</div></div><!-- fragment --></dd></dl>

<p class="definition">Definition at line <a class="el" href="database__admin__client_8cc_source.html#l00034">34</a> of file <a class="el" href="database__admin__client_8cc_source.html">database_admin_client.cc</a>.</p>

</div>
</div>
<a id="a75e7f11200ee24f0fb26b63972b0869f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75e7f11200ee24f0fb26b63972b0869f">&#9670;&nbsp;</a></span>GetDatabaseDdl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatusOr&lt; gcsa::GetDatabaseDdlResponse &gt; google::cloud::spanner::v0::DatabaseAdminClient::GetDatabaseDdl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a>&#160;</td>
          <td class="paramname"><em>db</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve a database schema. </p>
<dl class="section user"><dt>Idempotency</dt><dd>This is a read-only operation and therefore always idempotent. Transient failures are automatically retried.</dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#a75e7f11200ee24f0fb26b63972b0869f">GetDatabaseDdl</a>(google::cloud::spanner::DatabaseAdminClient client,</div><div class="line">                    std::string <span class="keyword">const</span>&amp; project_id,</div><div class="line">                    std::string <span class="keyword">const</span>&amp; instance_id,</div><div class="line">                    std::string <span class="keyword">const</span>&amp; database_id) {</div><div class="line">  <span class="keyword">namespace </span><a class="code" href="namespacegoogle_1_1cloud_1_1spanner.html">spanner</a> = ::google::cloud::spanner;</div><div class="line">  <span class="keyword">auto</span> database = client.GetDatabaseDdl(</div><div class="line">      spanner::Database(project_id, instance_id, database_id));</div><div class="line">  <span class="keywordflow">if</span> (!database) <span class="keywordflow">throw</span> std::runtime_error(database.status().message());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Database metadata is:\n&quot;</span> &lt;&lt; database-&gt;DebugString() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">}</div></div><!-- fragment --></dd></dl>

<p class="definition">Definition at line <a class="el" href="database__admin__client_8cc_source.html#l00038">38</a> of file <a class="el" href="database__admin__client_8cc_source.html">database_admin_client.cc</a>.</p>

</div>
</div>
<a id="a18fff0d95cb3a597746ae6253c7dbc24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18fff0d95cb3a597746ae6253c7dbc24">&#9670;&nbsp;</a></span>GetIamPolicy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatusOr&lt; google::iam::v1::Policy &gt; google::cloud::spanner::v0::DatabaseAdminClient::GetIamPolicy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a>&#160;</td>
          <td class="paramname"><em>db</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the IAM policy for a database. </p>
<dl class="section user"><dt>Idempotency</dt><dd>This operation is read-only and therefore always idempotent.</dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">void</span> DatabaseGetIamPolicy(google::cloud::spanner::DatabaseAdminClient client,</div><div class="line">                          std::string <span class="keyword">const</span>&amp; project_id,</div><div class="line">                          std::string <span class="keyword">const</span>&amp; instance_id,</div><div class="line">                          std::string <span class="keyword">const</span>&amp; database_id) {</div><div class="line">  google::cloud::spanner::Database database(project_id, instance_id,</div><div class="line">                                            database_id);</div><div class="line">  <span class="keyword">auto</span> actual = client.GetIamPolicy(database);</div><div class="line">  <span class="keywordflow">if</span> (!actual) <span class="keywordflow">throw</span> std::runtime_error(actual.status().message());</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;The IAM policy for database &quot;</span> &lt;&lt; database_id &lt;&lt; <span class="stringliteral">&quot; is:\n&quot;</span></div><div class="line">            &lt;&lt; actual-&gt;DebugString() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">}</div></div><!-- fragment --></dd></dl>

<p class="definition">Definition at line <a class="el" href="database__admin__client_8cc_source.html#l00057">57</a> of file <a class="el" href="database__admin__client_8cc_source.html">database_admin_client.cc</a>.</p>

</div>
</div>
<a id="ae787f480f6b2ecc3bee04c2b23428390"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae787f480f6b2ecc3bee04c2b23428390">&#9670;&nbsp;</a></span>ListDatabases()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacegoogle_1_1cloud_1_1spanner_1_1v0.html#ab2103cd7782fc4748867fa8ad2b35e09">ListDatabaseRange</a> google::cloud::spanner::v0::DatabaseAdminClient::ListDatabases </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Instance.html">Instance</a>&#160;</td>
          <td class="paramname"><em>in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>List all the databases in a give project and instance. </p>
<dl class="section user"><dt>Idempotency</dt><dd>This operation is read-only and therefore always idempotent.</dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1DatabaseAdminClient.html#ae787f480f6b2ecc3bee04c2b23428390">ListDatabases</a>(google::cloud::spanner::DatabaseAdminClient client,</div><div class="line">                   std::string <span class="keyword">const</span>&amp; project_id,</div><div class="line">                   std::string <span class="keyword">const</span>&amp; instance_id) {</div><div class="line">  google::cloud::spanner::Instance in(project_id, instance_id);</div><div class="line">  <span class="keywordtype">int</span> count = 0;</div><div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; database : client.ListDatabases(in)) {</div><div class="line">    <span class="keywordflow">if</span> (!database) <span class="keywordflow">throw</span> std::runtime_error(database.status().message());</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Database &quot;</span> &lt;&lt; database-&gt;name() &lt;&lt; <span class="stringliteral">&quot; full metadata:\n&quot;</span></div><div class="line">              &lt;&lt; database-&gt;DebugString() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">    ++count;</div><div class="line">  }</div><div class="line">  <span class="keywordflow">if</span> (count == 0) {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;No databases found in instance &quot;</span> &lt;&lt; instance_id</div><div class="line">              &lt;&lt; <span class="stringliteral">&quot; for project &lt;&lt; &quot;</span> &lt;&lt; project_id &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --></dd></dl>

<p class="definition">Definition at line <a class="el" href="database__admin__client_8cc_source.html#l00049">49</a> of file <a class="el" href="database__admin__client_8cc_source.html">database_admin_client.cc</a>.</p>

</div>
</div>
<a id="af8f5a36a409bf2f0161fdf37488a7d8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8f5a36a409bf2f0161fdf37488a7d8d">&#9670;&nbsp;</a></span>SetIamPolicy() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatusOr&lt; google::iam::v1::Policy &gt; google::cloud::spanner::v0::DatabaseAdminClient::SetIamPolicy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a>&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">google::iam::v1::Policy&#160;</td>
          <td class="paramname"><em>policy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the IAM policy for the given database. </p>
<p>This function changes the IAM policy configured in the given database to the value of <code>policy</code>.</p>
<dl class="section user"><dt>Idempotency</dt><dd>This function is only idempotent if the <code>etag</code> field in <code>policy</code> is set. Therefore, the underlying RPCs are only retried if the field is set, and the function returns the first RPC error in any other case.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>The <a href="https://cloud.google.com/spanner/docs/iam">Cloud Spanner documentation</a> for a description of the roles and permissions supported by Cloud Spanner. </dd>
<dd>
<a href="https://cloud.google.com/iam/docs/overview#permissions">IAM Overview</a> for an introduction to Identity and Access Management in Google Cloud Platform. </dd></dl>

<p class="definition">Definition at line <a class="el" href="database__admin__client_8cc_source.html#l00062">62</a> of file <a class="el" href="database__admin__client_8cc_source.html">database_admin_client.cc</a>.</p>

</div>
</div>
<a id="a8a27a871994081f7cb7ad726b4aecc60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a27a871994081f7cb7ad726b4aecc60">&#9670;&nbsp;</a></span>SetIamPolicy() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatusOr&lt; google::iam::v1::Policy &gt; google::cloud::spanner::v0::DatabaseAdminClient::SetIamPolicy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a> const &amp;&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegoogle_1_1cloud_1_1spanner_1_1v0.html#a17be538be6a68b58dc90bd72c47af092">IamUpdater</a> const &amp;&#160;</td>
          <td class="paramname"><em>updater</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the IAM policy for an instance using an optimistic concurrency control loop. </p>
<p>This function repeatedly reads the current IAM policy in <code>db</code>, and then calls the <code>updater</code> with the this policy. The <code>updater</code> returns an empty optional if no changes are required, or it returns the new desired value for the IAM policy. This function then updates the policy.</p>
<p>Updating an IAM policy can fail with retryable errors or can be aborted because there were simultaneous changes the to IAM policy. In these cases this function reruns the loop until it succeeds.</p>
<p>The function returns the final IAM policy, or an error if the rerun policy for the underlying connection has expired.</p>
<dl class="section user"><dt>Idempotency</dt><dd>This function always sets the <code>etag</code> field on the policy, so the underlying RPCs are retried automatically.</dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">void</span> AddDatabaseReaderOnDatabase(</div><div class="line">    google::cloud::spanner::DatabaseAdminClient client,</div><div class="line">    std::string <span class="keyword">const</span>&amp; project_id, std::string <span class="keyword">const</span>&amp; instance_id,</div><div class="line">    std::string <span class="keyword">const</span>&amp; database_id, std::string <span class="keyword">const</span>&amp; new_reader) {</div><div class="line">  google::cloud::spanner::Database database(project_id, instance_id,</div><div class="line">                                            database_id);</div><div class="line">  <span class="keyword">auto</span> current = client.GetIamPolicy(database);</div><div class="line">  <span class="keywordflow">if</span> (!current) <span class="keywordflow">throw</span> std::runtime_error(current.status().message());</div><div class="line"></div><div class="line">  <span class="comment">// Find (or create) the binding for &quot;roles/spanner.databaseReader&quot;.</span></div><div class="line">  <span class="keyword">auto</span>&amp; binding = [&amp;current]() -&gt; google::iam::v1::Binding&amp; {</div><div class="line">    <span class="keyword">auto</span> role_pos =</div><div class="line">        std::find_if(current-&gt;mutable_bindings()-&gt;begin(),</div><div class="line">                     current-&gt;mutable_bindings()-&gt;end(),</div><div class="line">                     [](google::iam::v1::Binding <span class="keyword">const</span>&amp; b) {</div><div class="line">                       <span class="keywordflow">return</span> b.role() == <span class="stringliteral">&quot;roles/spanner.databaseReader&quot;</span> &amp;&amp;</div><div class="line">                              !b.has_condition();</div><div class="line">                     });</div><div class="line">    <span class="keywordflow">if</span> (role_pos != current-&gt;mutable_bindings()-&gt;end()) {</div><div class="line">      <span class="keywordflow">return</span> *role_pos;</div><div class="line">    }</div><div class="line">    <span class="keyword">auto</span>&amp; binding = *current-&gt;add_bindings();</div><div class="line">    binding.set_role(<span class="stringliteral">&quot;roles/spanner.databaseReader&quot;</span>);</div><div class="line">    <span class="keywordflow">return</span> binding;</div><div class="line">  }();</div><div class="line"></div><div class="line">  <span class="keyword">auto</span> member_pos =</div><div class="line">      std::find(binding.members().begin(), binding.members().end(), new_reader);</div><div class="line">  <span class="keywordflow">if</span> (member_pos != binding.members().end()) {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;The entity &quot;</span> &lt;&lt; new_reader</div><div class="line">              &lt;&lt; <span class="stringliteral">&quot; is already a database reader:\n&quot;</span></div><div class="line">              &lt;&lt; current-&gt;DebugString();</div><div class="line">    <span class="keywordflow">return</span>;</div><div class="line">  }</div><div class="line"></div><div class="line">  binding.add_members(new_reader);</div><div class="line">  <span class="keyword">auto</span> result = client.SetIamPolicy(database, *std::move(current));</div><div class="line">  <span class="keywordflow">if</span> (!result) <span class="keywordflow">throw</span> std::runtime_error(result.status().message());</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Successfully added &quot;</span> &lt;&lt; new_reader</div><div class="line">            &lt;&lt; <span class="stringliteral">&quot; to the database reader role:\n&quot;</span></div><div class="line">            &lt;&lt; result-&gt;DebugString() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">}</div></div><!-- fragment --> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">db</td><td>the identifier for the database where you want to change the IAM policy. </td></tr>
    <tr><td class="paramname">updater</td><td>a callback to modify the policy. Return an unset optional to indicate that no changes to the policy are needed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="database__admin__client_8cc_source.html#l00067">67</a> of file <a class="el" href="database__admin__client_8cc_source.html">database_admin_client.cc</a>.</p>

</div>
</div>
<a id="ae3904f44d08265ea643460b60430b2f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3904f44d08265ea643460b60430b2f4">&#9670;&nbsp;</a></span>SetIamPolicy() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatusOr&lt; google::iam::v1::Policy &gt; google::cloud::spanner::v0::DatabaseAdminClient::SetIamPolicy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a> const &amp;&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacegoogle_1_1cloud_1_1spanner_1_1v0.html#a17be538be6a68b58dc90bd72c47af092">IamUpdater</a> const &amp;&#160;</td>
          <td class="paramname"><em>updater</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; <a class="el" href="namespacegoogle_1_1cloud_1_1spanner_1_1v0.html#a52b5d68feb45c40d761c79ee360b804c">TransactionRerunPolicy</a> &gt;&#160;</td>
          <td class="paramname"><em>rerun_policy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::unique_ptr&lt; <a class="el" href="namespacegoogle_1_1cloud_1_1spanner_1_1v0.html#ae9894cd07fd5d6262b10e01f1307c951">BackoffPolicy</a> &gt;&#160;</td>
          <td class="paramname"><em>backoff_policy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the IAM policy for an instance using an optimistic concurrency control loop. </p>
<p>This function repeatedly reads the current IAM policy in <code>db</code>, and then calls the <code>updater</code> with the this policy. The <code>updater</code> returns an empty optional if no changes are required, or it returns the new desired value for the IAM policy. This function then updates the policy.</p>
<p>Updating an IAM policy can fail with retryable errors or can be aborted because there were simultaneous changes the to IAM policy. In these cases this function reruns the loop until it succeeds.</p>
<p>The function returns the final IAM policy, or an error if the rerun policy for the underlying connection has expired.</p>
<dl class="section user"><dt>Idempotency</dt><dd>This function always sets the <code>etag</code> field on the policy, so the underlying RPCs are retried automatically.</dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">void</span> AddDatabaseReaderOnDatabase(</div><div class="line">    google::cloud::spanner::DatabaseAdminClient client,</div><div class="line">    std::string <span class="keyword">const</span>&amp; project_id, std::string <span class="keyword">const</span>&amp; instance_id,</div><div class="line">    std::string <span class="keyword">const</span>&amp; database_id, std::string <span class="keyword">const</span>&amp; new_reader) {</div><div class="line">  google::cloud::spanner::Database database(project_id, instance_id,</div><div class="line">                                            database_id);</div><div class="line">  <span class="keyword">auto</span> current = client.GetIamPolicy(database);</div><div class="line">  <span class="keywordflow">if</span> (!current) <span class="keywordflow">throw</span> std::runtime_error(current.status().message());</div><div class="line"></div><div class="line">  <span class="comment">// Find (or create) the binding for &quot;roles/spanner.databaseReader&quot;.</span></div><div class="line">  <span class="keyword">auto</span>&amp; binding = [&amp;current]() -&gt; google::iam::v1::Binding&amp; {</div><div class="line">    <span class="keyword">auto</span> role_pos =</div><div class="line">        std::find_if(current-&gt;mutable_bindings()-&gt;begin(),</div><div class="line">                     current-&gt;mutable_bindings()-&gt;end(),</div><div class="line">                     [](google::iam::v1::Binding <span class="keyword">const</span>&amp; b) {</div><div class="line">                       <span class="keywordflow">return</span> b.role() == <span class="stringliteral">&quot;roles/spanner.databaseReader&quot;</span> &amp;&amp;</div><div class="line">                              !b.has_condition();</div><div class="line">                     });</div><div class="line">    <span class="keywordflow">if</span> (role_pos != current-&gt;mutable_bindings()-&gt;end()) {</div><div class="line">      <span class="keywordflow">return</span> *role_pos;</div><div class="line">    }</div><div class="line">    <span class="keyword">auto</span>&amp; binding = *current-&gt;add_bindings();</div><div class="line">    binding.set_role(<span class="stringliteral">&quot;roles/spanner.databaseReader&quot;</span>);</div><div class="line">    <span class="keywordflow">return</span> binding;</div><div class="line">  }();</div><div class="line"></div><div class="line">  <span class="keyword">auto</span> member_pos =</div><div class="line">      std::find(binding.members().begin(), binding.members().end(), new_reader);</div><div class="line">  <span class="keywordflow">if</span> (member_pos != binding.members().end()) {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;The entity &quot;</span> &lt;&lt; new_reader</div><div class="line">              &lt;&lt; <span class="stringliteral">&quot; is already a database reader:\n&quot;</span></div><div class="line">              &lt;&lt; current-&gt;DebugString();</div><div class="line">    <span class="keywordflow">return</span>;</div><div class="line">  }</div><div class="line"></div><div class="line">  binding.add_members(new_reader);</div><div class="line">  <span class="keyword">auto</span> result = client.SetIamPolicy(database, *std::move(current));</div><div class="line">  <span class="keywordflow">if</span> (!result) <span class="keywordflow">throw</span> std::runtime_error(result.status().message());</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Successfully added &quot;</span> &lt;&lt; new_reader</div><div class="line">            &lt;&lt; <span class="stringliteral">&quot; to the database reader role:\n&quot;</span></div><div class="line">            &lt;&lt; result-&gt;DebugString() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">}</div></div><!-- fragment --> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">db</td><td>the identifier for the database where you want to change the IAM policy. </td></tr>
    <tr><td class="paramname">updater</td><td>a callback to modify the policy. Return an unset optional to indicate that no changes to the policy are needed.</td></tr>
    <tr><td class="paramname">rerun_policy</td><td>controls for how long (or how many times) the updater will be rerun after the IAM policy update aborts. </td></tr>
    <tr><td class="paramname">backoff_policy</td><td>controls how long <code>SetIamPolicy</code> waits between reruns. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="database__admin__client_8cc_source.html#l00085">85</a> of file <a class="el" href="database__admin__client_8cc_source.html">database_admin_client.cc</a>.</p>

</div>
</div>
<a id="a440216e84d05c6e7f7fd285012d342e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a440216e84d05c6e7f7fd285012d342e8">&#9670;&nbsp;</a></span>TestIamPermissions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">StatusOr&lt; google::iam::v1::TestIamPermissionsResponse &gt; google::cloud::spanner::v0::DatabaseAdminClient::TestIamPermissions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a>&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>permissions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the subset of the permissions the caller has on the given database. </p>
<p>This function compares the given list of permissions against those permissions granted to the caller, and returns the subset of the list that the caller actually holds.</p>
<dl class="section note"><dt>Note</dt><dd>Permission wildcards, such as <code>spanner.*</code> are not allowed.</dd></dl>
<dl class="section user"><dt>Idempotency</dt><dd>This operation is read-only and therefore always idempotent.</dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">void</span> DatabaseTestIamPermissions(</div><div class="line">    google::cloud::spanner::DatabaseAdminClient client,</div><div class="line">    std::string <span class="keyword">const</span>&amp; project_id, std::string <span class="keyword">const</span>&amp; instance_id,</div><div class="line">    std::string <span class="keyword">const</span>&amp; database_id, std::string <span class="keyword">const</span>&amp; permission) {</div><div class="line">  google::cloud::spanner::Database db(project_id, instance_id, database_id);</div><div class="line">  <span class="keyword">auto</span> actual = client.TestIamPermissions(db, {permission});</div><div class="line">  <span class="keywordflow">if</span> (!actual) <span class="keywordflow">throw</span> std::runtime_error(actual.status().message());</div><div class="line"></div><div class="line">  <span class="keywordtype">char</span> <span class="keyword">const</span>* msg = actual-&gt;permissions().empty() ? <span class="stringliteral">&quot;does not&quot;</span> : <span class="stringliteral">&quot;does&quot;</span>;</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;The caller &quot;</span> &lt;&lt; msg &lt;&lt; <span class="stringliteral">&quot; have permission &#39;&quot;</span> &lt;&lt; permission</div><div class="line">            &lt;&lt; <span class="stringliteral">&quot;&#39; on the Cloud Spanner database &quot;</span> &lt;&lt; db.database_id() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line">}</div></div><!-- fragment --> </dd></dl>
<dl class="section see"><dt>See also</dt><dd>The <a href="https://cloud.google.com/spanner/docs/iam">Cloud Spanner documentation</a> for a description of the roles and permissions supported by Cloud Spanner. </dd>
<dd>
<a href="https://cloud.google.com/iam/docs/overview#permissions">IAM Overview</a> for an introduction to Identity and Access Management in Google Cloud Platform. </dd></dl>

<p class="definition">Definition at line <a class="el" href="database__admin__client_8cc_source.html#l00116">116</a> of file <a class="el" href="database__admin__client_8cc_source.html">database_admin_client.cc</a>.</p>

</div>
</div>
<a id="a772381bd10480013561ad30dccd3f7db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a772381bd10480013561ad30dccd3f7db">&#9670;&nbsp;</a></span>UpdateDatabase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">future&lt; StatusOr&lt; gcsa::UpdateDatabaseDdlMetadata &gt; &gt; google::cloud::spanner::v0::DatabaseAdminClient::UpdateDatabase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classgoogle_1_1cloud_1_1spanner_1_1v0_1_1Database.html">Database</a>&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>statements</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the database using a series of DDL statements. </p>
<p>This function schedules a series of updates to the database using a sequence of DDL statements.</p>
<dl class="section return"><dt>Returns</dt><dd>A <code>google::cloud::future</code> that becomes satisfied when all the statements complete. Note that Cloud Spanner may fail to execute some of the statements.</dd></dl>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">void</span> AddColumn(google::cloud::spanner::DatabaseAdminClient client,</div><div class="line">               std::string <span class="keyword">const</span>&amp; project_id, std::string <span class="keyword">const</span>&amp; instance_id,</div><div class="line">               std::string <span class="keyword">const</span>&amp; database_id) {</div><div class="line">  using ::google::cloud::future;</div><div class="line">  using ::google::cloud::StatusOr;</div><div class="line">  google::cloud::spanner::Database database(project_id, instance_id,</div><div class="line">                                            database_id);</div><div class="line">  future&lt;</div><div class="line">      StatusOr&lt;google::spanner::admin::database::v1::UpdateDatabaseDdlMetadata&gt;&gt;</div><div class="line">      f = client.UpdateDatabase(</div><div class="line">          database, {<span class="stringliteral">&quot;ALTER TABLE Albums ADD COLUMN MarketingBudget INT64&quot;</span>});</div><div class="line">  StatusOr&lt;google::spanner::admin::database::v1::UpdateDatabaseDdlMetadata&gt;</div><div class="line">      metadata = f.get();</div><div class="line">  <span class="keywordflow">if</span> (!metadata) <span class="keywordflow">throw</span> std::runtime_error(metadata.status().message());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Added MarketingBudget column\n&quot;</span>;</div><div class="line">}</div></div><!-- fragment --> </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://cloud.google.com/spanner/docs/data-definition-language">https://cloud.google.com/spanner/docs/data-definition-language</a> for a full list of the DDL operations </dd></dl>

<p class="definition">Definition at line <a class="el" href="database__admin__client_8cc_source.html#l00044">44</a> of file <a class="el" href="database__admin__client_8cc_source.html">database_admin_client.cc</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
